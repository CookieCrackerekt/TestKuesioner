<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="msapplication-TileColor" content="#0E0E0E">
  <meta name="template-color" content="#0E0E0E">
  <meta name="description" content="Index page">
  <meta name="keywords" content="index, page">
  <meta name="author" content="">
  <link rel="shortcut icon" type="image/x-icon" href="assets/imgs/template/favicon.svg">
  <link href="assets/css/style%EF%B9%96v=6.0.0.css" rel="stylesheet">
  <title>SIP Kemendag - Kuesioner</title>
  <style>
    input[type="radio"] {
      accent-color: #0d6efd;
    }

    .progress-indicator {
      height: 4px;
      background-color: #e9ecef;
      border-radius: 2px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(135deg, #0d6efd, #066a4c);
      transition: width 0.3s ease;
    }

    main.container {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      background-color: none;
    }

    #progressContainer {
      flex-shrink: 0;
    }

    #soalContainer {
      flex-grow: 1;
    }

    #navigationContainer {
      flex-shrink: 0;
      margin-top: auto;
      padding-top: 1rem;
      padding-bottom: 1rem;
      background: none;
      position: sticky;
      bottom: 0;
    }

    #btnPrev,
    #btnSkip {
      background-color: #192a56;
      color: #ffe7bb;
      border: none;
      /* biar ga ada border outline default */
      transition: all 0.3s ease;
      /* buat animasi halus */
    }

    #btnPrev:hover,
    #btnSkip:hover {
      background-color: #066a4c;
      color: #ffe7bb;
      /* biar teks tetap kontras */
      transform: translateY(-3px);
      /* naik dikit */
    }

    /* Styling reset button tambahan */
    #btnReset {
      background: linear-gradient(45deg, #f2961a, #f9c700);
      color: #ffe7bb;
      border: none;
      transition: all 0.3s ease;
    }

    #btnReset:hover {
      background: #6a0606;
      transform: translateY(-3px);
      color: #ffe7bb;
    }

    #btnReset:active {
      transform: translateY(0);
    }
  </style>
</head>

<body>
  <div id="preloader-active">
    <div class="preloader d-flex align-items-center justify-content-center">
      <div class="preloader-inner position-relative">
        <div class="page-loading">
          <div class="page-loading-inner">
            <div></div>
            <div></div>
            <div></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <header class="header sticky-bar">
    <div class="container">
      <div class="main-header">
        <div class="header-left">
          <div class="header-logo"><a class="d-flex" href="index.html"><img alt="Ecom"
                src="assets/imgs/template/logo-sip.svg"></a></div>
          <div class="header-nav">
            <nav class="nav-main-menu d-none d-xl-block">
              <ul class="main-menu">
                <li><a href="index.html">Beranda</a></li>
                <li><a href="index.html">Informasi</a></li>
                <li><a a class="active" href="Kuesioner.html">Kuesioner</a></li>
              </ul>
            </nav>
            <div class="burger-icon burger-icon-white"><span class="burger-icon-top"></span><span
                class="burger-icon-mid"></span><span class="burger-icon-bottom"></span></div>
          </div>
          <div class="header-right">
            <div class="d-inline-block box-search-top">
              <div class="form-search-top">
                <form action="#">
                  <input class="input-search" type="text" placeholder="Search...">
                  <button class="btn btn-search">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"
                      xmlns="http://www.w3.org/2000/svg">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                  </button>
                </form>
              </div><span class="font-lg icon-list search-post">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg></span>
            </div>
            <div class="d-inline-block box-dropdown-cart"><span class="font-lg icon-list icon-account"><span
                  class="font-lg color-grey-900 arrow-down">EN</span></span>
              <div class="dropdown-account">
                <ul>
                  <li><a class="font-md" href="#"><img src="assets/imgs/template/icons/en.png" alt="iori">
                      English</a></li>
                  <li><a class="font-md" href="#"><img src="assets/imgs/template/icons/fr.png" alt="iori">
                      French</a></li>
                  <li><a class="font-md" href="#"><img src="assets/imgs/template/icons/cn.png" alt="iori">
                      Chiness</a></li>
                </ul>
              </div>
            </div>
            <div class="d-none d-sm-inline-block"><a class="btn btn-brand-1 hover-up" href="register.html">Masuk</a></div>
          </div>
        </div>
      </div>
    </div>
  </header>
  <div class="mobile-header-active mobile-header-wrapper-style perfect-scrollbar">
    <div class="mobile-header-wrapper-inner">
      <div class="mobile-header-content-area">
        <div class="mobile-logo"><a class="d-flex" href="index.html"><img alt="IORI"
              src="assets/imgs/template/logo-sip.svg"></a></div>
        <div class="burger-icon"><span class="burger-icon-top"></span><span class="burger-icon-mid"></span><span
            class="burger-icon-bottom"></span></div>
        <div class="perfect-scroll">
          <div class="mobile-menu-wrap mobile-header-border">
            <ul class="nav nav-tabs nav-tabs-mobile mt-25" role="tablist">
              <li><a class="active" href="#tab-menu" data-bs-toggle="tab" role="tab" aria-controls="tab-menu"
                  aria-selected="true">
                  <svg class="w-6 h-6 icon-16" fill="none" stroke="currentColor" viewbox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16">
                    </path>
                  </svg>Menu</a></li>
              <li><a href="#tab-account" data-bs-toggle="tab" role="tab" aria-controls="tab-account"
                  aria-selected="false">
                  <svg class="w-6 h-6 icon-16" fill="none" stroke="currentColor" viewbox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                  </svg>Account</a></li>
              <li><a href="#tab-notification" data-bs-toggle="tab" role="tab" aria-controls="tab-notification"
                  aria-selected="false">
                  <svg class="w-6 h-6 icon-16" fill="none" stroke="currentColor" viewbox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9">
                    </path>
                  </svg>Notification</a></li>
            </ul>
            <div class="tab-content">
              <div class="tab-pane fade active show" id="tab-menu" role="tabpanel" aria-labelledby="tab-menu">
                <nav class="mt-15">
                  <ul class="mobile-menu font-heading">
                    <li><a href="index.html">Beranda</a></li>
                    <li><a href="index.html">Informasi</a></li>
                    <li><a a class="active" href="Kuesioner.html">Kuesioner</a></li>
                  </ul>
                </nav>
              </div>
              <div class="tab-pane fade" id="tab-account" role="tabpanel" aria-labelledby="tab-account">
                <nav class="mt-15">
                  <ul class="mobile-menu font-heading">
                    <li><a class="active" href="login.html">My Profile</a></li>
                    <li><a href="#">Work Preferences</a></li>
                    <li><a href="#">My Boosted Shots</a></li>
                    <li><a href="#">My Collections</a></li>
                    <li><a href="#">Account Settings</a></li>
                    <li><a href="#">Go Pro</a></li>
                    <li><a href="register.html">Sign Out</a></li>
                  </ul>
                </nav>
              </div>
              <div class="tab-pane fade" id="tab-notification" role="tabpanel" aria-labelledby="tab-notification">
                <p class="font-sm-bold color-brand-1 mt-30">Today</p>
                <div class="notifications-item">
                  <div class="item-notify">
                    <div class="item-image"><img src="assets/imgs/template/user1.png" alt="iori"></div>
                    <div class="item-info">
                      <p class="color-grey-500 font-xs"><strong class="font-xs-bold">Steven Job</strong>like started a
                        poll in your post ‚ÄúHow to be a good trader in 2025‚Äù</p>
                    </div>
                    <div class="item-time"><span class="color-grey-500 font-xs">Just now</span></div>
                  </div>
                  <div class="item-notify">
                    <div class="item-image"><img src="assets/imgs/template/user2.png" alt="iori"></div>
                    <div class="item-info">
                      <p class="color-grey-500 font-xs"><strong class="font-xs-bold">Steven Job</strong>like started a
                        poll in your post ‚ÄúHow to be a good trader in 2025‚Äù</p>
                    </div>
                    <div class="item-time"><span class="color-grey-500 font-xs">Just now</span></div>
                  </div>
                </div>
                <p class="font-sm-bold color-brand-1 mt-30">Yesterday</p>
                <div class="notifications-item">
                  <div class="item-notify">
                    <div class="item-image"><img src="assets/imgs/template/user3.png" alt="iori"></div>
                    <div class="item-info">
                      <p class="color-grey-500 font-xs"><strong class="font-xs-bold">Steven Job</strong>like started a
                        poll in your post ‚ÄúHow to be a good trader in 2025‚Äù</p>
                    </div>
                    <div class="item-time"><span class="color-grey-500 font-xs">Just now</span></div>
                  </div>
                  <div class="item-notify">
                    <div class="item-image"><img src="assets/imgs/template/user4.png" alt="iori"></div>
                    <div class="item-info">
                      <p class="color-grey-500 font-xs"><strong class="font-xs-bold">Steven Job</strong>like started a
                        poll in your post ‚ÄúHow to be a good trader in 2025‚Äù</p>
                    </div>
                    <div class="item-time"><span class="color-grey-500 font-xs">Just now</span></div>
                  </div>
                  <div class="item-notify">
                    <div class="item-image"><img src="assets/imgs/template/user5.png" alt="iori"></div>
                    <div class="item-info">
                      <p class="color-grey-500 font-xs"><strong class="font-xs-bold">Steven Job</strong>like started a
                        poll in your post ‚ÄúHow to be a good trader in 2025‚Äù</p>
                    </div>
                    <div class="item-time"><span class="color-grey-500 font-xs">Just now</span></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="site-copyright color-grey-400 mt-0">
            <div class="box-download-app">
              <p class="font-xs color-grey-400 mb-25">Download our Apps and get extra 15% Discount on your first Order‚Ä¶!
              </p>
              <div class="mb-25"><a class="mr-10" href="#"><img src="assets/imgs/template/appstore.png"
                    alt="iori"></a><a href="#"><img src="assets/imgs/template/google-play.png" alt="iori"></a></div>
              <p class="font-sm color-grey-400 mt-20 mb-10">Secured Payment Gateways</p><img
                src="assets/imgs/template/payment-method.png" alt="iori">
            </div>
            <div class="mb-0">Copyright 2025 &copy; IORI - Marketplace Template.<br>Designed by<a
                href="http://alithemes.com" target="_blank">&nbsp; AliThemes</a></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <main class="main">
    <section class="section">
      <div class="container py-4">
        <!-- Progress Bar -->
        <div id="progressContainer" class="mb-4">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <small class="text-muted">Progress</small>
            <small class="text-muted" id="progressText">0/0</small>
          </div>
          <div class="progress-indicator">
            <div class="progress-fill" id="progressBar" style="width: 0%"></div>
          </div>
        </div>
        <!-- Soal Container -->
        <div id="soalContainer" class="mb-4"></div>
        <!-- Navigasi -->
        <div id="navigationContainer" class="d-flex justify-content-between align-items-center">
          <!-- Kiri -->
          <div class="d-inline-block">
            <button type="button" id="btnPrev" class="btn btn-brand-1 hover-up" disabled>
              <span class="d-none d-sm-inline">‚Üê Sebelumnya</span>
              <span class="d-inline d-sm-none">‚Üê</span>
            </button>
          </div>
          <!-- Tengah -->
          <div class="d-inline-block">
            <button type="button" id="btnReset" class="btn btn-brand-1 hover-up">
              <span class="d-none d-sm-inline">Reset Survey</span>
              <span class="d-inline d-sm-none">‚Üª</span>
            </button>
          </div>
          <!-- Kanan -->
          <div class="d-inline-block">
            <button type="button" id="btnSkip" class="btn btn-brand-1 hover-up">
              <span class="d-none d-sm-inline">Selanjutnya ‚Üí</span>
              <span class="d-inline d-sm-none">‚Üí</span>
            </button>
            <button type="button" id="btnSelesai" class="btn btn-brand-1 hover-up" style="display: none">
              Selesai
            </button>
          </div>

        </div>
        <!-- Hasil Klasifikasi -->
        <section id="hasilKlasifikasi" class="mt-5" style="display: none">
          <div class="row justify-content-center">
            <div class="col-lg-8">
              <div class="card shadow-lg border-0">
                <div class="card-header bg-primary text-white text-center py-4" style="
                    background: linear-gradient(
                      135deg,
                      #0d6efd,
                      #6610f2
                    ) !important;
                  ">
                  <h3 class="mb-0">üéâ Hasil Survey Kesiapan Ekspor</h3>
                </div>
                <div class="card-body p-4">
                  <div class="text-center mb-4">
                    <h4 id="status" class="text-primary mb-2">‚Äî</h4>
                    <p id="statusDesc" class="text-muted mb-0">
                      Terima kasih telah mengisi survey!
                    </p>
                  </div>
                  <div class="row g-3 mb-4">
                    <div class="col-md-6">
                      <div class="bg-light rounded p-3">
                        <div class="small text-muted">Total Kategori X</div>
                        <div id="sumX" class="fs-4 fw-bold text-primary">0</div>
                        <div class="progress mt-2" style="height: 6px">
                          <div id="barX" class="progress-bar bg-primary" style="width: 0%"></div>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="bg-light rounded p-3">
                        <div class="small text-muted">Total Kategori Y</div>
                        <div id="sumY" class="fs-4 fw-bold text-info">0</div>
                        <div class="progress mt-2" style="height: 6px">
                          <div id="barY" class="progress-bar bg-info" style="width: 0%"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="text-center">
                    <button type="button" id="btnMulaiUlang" class="btn btn-brand-1 hover-up">
                      Mulai Survey Lagi
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="footer-1">
      <div class="container">
        <div class="row">
          <div class="col-lg-3 width-20">
            <div class="mb-10"><img src="assets/imgs/template/logo-sip.svg" alt="iori"></div>
            <p class="font-md mb-20 color-grey-400">4517 Washington Ave.<br class="d-none d-lg-block">Manchester,
              Kentucky 39495</p>
            <div class="font-md mb-20 color-grey-400"><strong class="font-md-bold">Hours:</strong> 8:00 - 17:00, Mon -
              Sat</div>
            <h6 class="color-brand-1">Follow Us</h6>
            <div class="mt-15"><a class="icon-socials icon-facebook" href="#"></a><a class="icon-socials icon-instagram"
                href="#"></a><a class="icon-socials icon-twitter" href="#"></a><a class="icon-socials icon-linkedin"
                href="#"></a><a class="icon-socials icon-youtube" href="#"></a></div>
          </div>
          <div class="col-lg-3 width-16 mb-30">
            <h5 class="mb-10 color-brand-1">About Us</h5>
            <ul class="menu-footer">
              <li><a href="about.html">Mission &amp; Vision</a></li>
              <li><a href="team.html">Our Team</a></li>
              <li><a href="career.html">Careers</a></li>
              <li><a href="#">Press &amp; Media</a></li>
              <li><a href="#">Advertising</a></li>
              <li><a href="#">Testimonials</a></li>
            </ul>
          </div>
          <div class="col-lg-3 width-16 mb-30">
            <h5 class="mb-10 color-brand-1">Ressources</h5>
            <ul class="menu-footer">
              <li><a href="#">Project managemen</a></li>
              <li><a href="#">Solutions</a></li>
              <li><a href="#">Customers</a></li>
              <li><a href="#">News & Events</a></li>
              <li><a href="#">Careers</a></li>
              <li><a href="#">Support</a></li>
            </ul>
          </div>
          <div class="col-lg-3 width-16 mb-30">
            <h5 class="mb-10 color-brand-1">We offer</h5>
            <ul class="menu-footer">
              <li><a href="#">Project software</a></li>
              <li><a href="#">Resource software</a></li>
              <li><a href="#">Workflow automation</a></li>
              <li><a href="#">Gantt chart makers</a></li>
              <li><a href="#">Project dashboards</a></li>
              <li><a href="#">Task software</a></li>
            </ul>
          </div>
          <div class="col-lg-3 width-23">
            <h5 class="mb-10 color-brand-1">App &amp; Payment</h5>
            <div>
              <p class="font-sm color-grey-400">Download our Apps and get extra 15% Discount on your first Order‚Ä¶!</p>
              <div class="mt-20"><a class="mr-10" href="#"><img src="assets/imgs/template/appstore.png"
                    alt="iori"></a><a href="#"><img src="assets/imgs/template/google-play.png" alt="iori"></a></div>
              <p class="font-sm color-grey-400 mt-20 mb-10">Secured Payment Gateways</p><img
                src="assets/imgs/template/payment-method.png" alt="iori">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="footer-2">
      <div class="container">
        <div class="footer-bottom">
          <div class="row">
            <div class="col-lg-6 col-md-12 text-center text-lg-start">
              <ul class="menu-bottom">
                <li><a class="font-sm color-grey-300" href="term-conditions.html">Privacy policy</a></li>
                <li><a class="font-sm color-grey-300" href="term-conditions.html">Cookies</a></li>
                <li><a class="font-sm color-grey-300" href="term-conditions.html">Terms of service</a></li>
              </ul>
            </div>
            <div class="col-lg-6 col-md-12 text-center text-lg-end"><span class="color-grey-300 font-md">¬©Iori Official
                2025. All right reversed.</span></div>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <script>
    const API_URL = "https://arif.id/api/soal";
    const VAR_FALLBACK = null;

    let currentQuestionIndex = 0;
    let allData = [];
    let formAnswers = {};
    let surveyFinished = false; // ‚úÖ flag untuk tandai survey selesai

    function updateProgress() {
      const total = allData.length;
      const answered = Object.keys(formAnswers).length;
      const percentage = total > 0 ? (answered / total) * 100 : 0;

      document.getElementById(
        "progressText"
      ).textContent = `${answered}/${total} terjawab`;
      document.getElementById("progressBar").style.width = `${percentage}%`;
    }

    function renderCurrentQuestion() {
      if (currentQuestionIndex >= allData.length) {
        showResults();
        return;
      }

      const container = document.getElementById("soalContainer");
      const item = allData[currentQuestionIndex];

      const opts = item.pilihan_jawaban
        .map((opt, i) => {
          const valueCombined = `${opt.value} | ${opt.jawaban}`;
          const id = `q${currentQuestionIndex}_opt${i}`;
          const isChecked =
            formAnswers[currentQuestionIndex] === valueCombined
              ? "checked"
              : "";

          return `
        <div class="form-check mb-3 d-flex align-items-center">
          <input class="form-check-input me-3" type="radio" name="currentQuestion"
                id="${id}" value="${valueCombined}" data-score="${opt.value}" ${isChecked}>
          <label class="form-check-label flex-grow-1 border rounded p-3 mb-0" for="${id}">
            ${opt.jawaban}
          </label>
        </div>
      `;
        })
        .join("");

      container.innerHTML = `
  <div class="card shadow-sm border-0">
    <div class="card-header" style="background-color:#066a4c;">
      <div class="d-flex justify-content-between align-items-center w-100">
        <span style="color: #ffe7bb; font-weight: bold;">Pertanyaan ${currentQuestionIndex + 1
        }</span>
      </div>
    </div>
    <div class="card-body">
      <h5 class="card-title mb-4 question-text">${item.soal}</h5>
      <div data-kategori="${(item.kategori || "").toLowerCase()}">${opts}</div>
    </div>
  </div>
`;

      container.querySelectorAll('input[type="radio"]').forEach((input) => {
        input.addEventListener("change", (e) => {
          formAnswers[currentQuestionIndex] = e.target.value;
          calculateAndDisplay();
          updateProgress();
          updateNavigation();

          setTimeout(() => {
            if (currentQuestionIndex < allData.length - 1) {
              currentQuestionIndex++;
              renderCurrentQuestion();
            } else {
              updateNavigation();
            }
          }, 500);
        });
      });

      updateNavigation();
      updateProgress();
    }

    function updateNavigation() {
      if (surveyFinished) return; // ‚úÖ stop kalau sudah selesai

      const btnPrev = document.getElementById("btnPrev");
      const btnSkip = document.getElementById("btnSkip");
      const btnSelesai = document.getElementById("btnSelesai");

      btnPrev.disabled = currentQuestionIndex === 0;

      if (currentQuestionIndex === allData.length - 1) {
        btnSkip.style.display = "none";
      } else {
        btnSkip.style.display = "inline-block";
      }

      const totalQuestions = allData.length;
      const answeredQuestions = Object.keys(formAnswers).length;
      const allAnswered = answeredQuestions === totalQuestions;

      if (currentQuestionIndex === allData.length - 1 && allAnswered) {
        btnSelesai.style.display = "inline-block";
        btnSelesai.disabled = false;
      } else if (currentQuestionIndex === allData.length - 1) {
        btnSelesai.style.display = "inline-block";
        btnSelesai.disabled = true;
        btnSelesai.textContent = `Selesai`;
      } else {
        btnSelesai.style.display = "none";
        btnSelesai.disabled = false;
        btnSelesai.textContent = "Selesai";
      }
    }

    function showResults() {
      surveyFinished = true; // ‚úÖ tandai sudah selesai

      document.getElementById("soalContainer").style.display = "none";
      document.getElementById("progressContainer").style.display = "none";
      document.getElementById("btnPrev").style.display = "none";
      document.getElementById("btnSkip").style.display = "none";
      document.getElementById("btnSelesai").style.display = "none";
      document.getElementById("btnReset").style.display = "none";

      document.getElementById("hasilKlasifikasi").style.display = "block";

      document.getElementById("hasilKlasifikasi").scrollIntoView({
        behavior: "smooth",
      });
    }

    function resetSurvey() {
      surveyFinished = false; // ‚úÖ reset flag
      formAnswers = {};
      currentQuestionIndex = 0;

      document.getElementById("soalContainer").style.display = "block";
      document.getElementById("navigationContainer").style.display = "flex";
      document.getElementById("progressContainer").style.display = "block";
      document.getElementById("btnPrev").style.display = "block";
      document.getElementById("btnSkip").style.display = "block";
      document.getElementById("btnSelesai").style.display = "block";
      document.getElementById("btnReset").style.display = "block";

      document.getElementById("hasilKlasifikasi").style.display = "none";
      renderCurrentQuestion();
    }

    function shuffleArray(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function calculateAndDisplay() {
      let sumX = 0,
        sumY = 0;

      for (const [questionIndex, answer] of Object.entries(formAnswers)) {
        if (!answer) continue;
        const idx = parseInt(questionIndex);
        const item = allData[idx];
        if (!item) continue;

        const kategori = (item.kategori || "").toLowerCase();
        const score = parseInt(answer.split("|")[0], 10) || 0;

        if (kategori === "x") sumX += score;
        else if (kategori === "y") sumY += score;
      }

      document.getElementById("sumX").textContent = sumX;
      document.getElementById("sumY").textContent = sumY;

      const maxX = 22,
        maxY = 49;
      document.getElementById("barX").style.width =
        Math.min(100, (sumX / maxX) * 100) + "%";
      document.getElementById("barY").style.width =
        Math.min(100, (sumY / maxY) * 100) + "%";

      let status = "";
      if (sumX < 15 && sumY < 25) status = "Ready to Start";
      else if (sumX >= 15 && sumY < 25) status = "Potential Exportir";
      else if (sumX < 15 && sumY >= 25) status = "Emerging Exportir";
      else status = "Established Exportir";

      document.getElementById("status").textContent = status;
      const descMap = {
        "Ready to Start":
          "Fondasi awal ada. Perkuat kapasitas & pemahaman ekspor.",
        "Potential Exportir":
          "Potensi internal kuat. Perluas kesiapan pasar & strategi.",
        "Emerging Exportir":
          "Kesiapan pasar bagus. Perkuat kapasitas internal.",
        "Established Exportir": "Matang. Fokus scale-up & efisiensi.",
      };
      document.getElementById("statusDesc").textContent =
        descMap[status] || "";
    }

    async function init() {
      const container = document.getElementById("soalContainer");
      container.innerHTML = `
            <div class="card shadow-sm">
              <div class="card-body text-center">
                <div class="placeholder-glow">
                  <span class="placeholder col-6 mb-3"></span>
                  <span class="placeholder col-8"></span>
                </div>
                <div class="spinner-border text-primary mt-3" role="status">
                  <span class="visually-hidden">Loading...</span>
                </div>
              </div>
            </div>
          `;

      let data = VAR_FALLBACK;
      if (!data) {
        try {
          const res = await fetch(API_URL, { cache: "no-store" });
          if (!res.ok) throw new Error("Gagal memuat soal.json");
          data = await res.json();
          data = shuffleArray(data);
        } catch (e) {
          container.innerHTML = `
                <div class="alert alert-danger text-center">
                  <h5>‚ö†Ô∏è Gagal memuat data soal</h5>
                  <p class="mb-0">Pastikan <code>${API_URL}</code> dapat diakses.</p>
                </div>`;
          return;
        }
      }

      allData = data;
      currentQuestionIndex = 0;
      renderCurrentQuestion();
    }

    function attachNavigationListeners() {
      document.getElementById("btnPrev").addEventListener("click", () => {
        if (currentQuestionIndex > 0) {
          currentQuestionIndex--;
          renderCurrentQuestion();
        }
      });

      document.getElementById("btnSkip").addEventListener("click", () => {
        if (currentQuestionIndex < allData.length - 1) {
          currentQuestionIndex++;
          renderCurrentQuestion();
        }
      });

      document.getElementById("btnSelesai").addEventListener("click", () => {
        const totalQuestions = allData.length;
        const answeredQuestions = Object.keys(formAnswers).length;

        if (answeredQuestions === totalQuestions) {
          showResults();
          calculateAndDisplay();
        } else {
          alert(
            `Mohon jawab semua pertanyaan terlebih dahulu. (${answeredQuestions}/${totalQuestions} terjawab)`
          );
        }
      });

      document.getElementById("btnReset").addEventListener("click", () => {
        if (confirm("Apakah Anda yakin ingin mengulang survey dari awal?")) {
          resetSurvey();
        }
      });
    }

    attachNavigationListeners();
    document.getElementById("btnMulaiUlang").addEventListener("click", () => {
      resetSurvey();
    });

    init();
  </script>
  <script src="assets/js/vendors/modernizr-3.6.0.min.js"></script>
  <script src="assets/js/vendors/jquery-3.7.1.min.js"></script>
  <script src="assets/js/vendors/jquery-migrate-3.3.0.min.js"></script>
  <script src="assets/js/vendors/bootstrap.bundle.min.js"></script>
  <script src="assets/js/vendors/waypoints.js"></script>
  <script src="assets/js/vendors/wow.js"></script>
  <script src="assets/js/vendors/magnific-popup.js"></script>
  <script src="assets/js/vendors/perfect-scrollbar.min.js"></script>
  <script src="assets/js/vendors/select2.min.js"></script>
  <script src="assets/js/vendors/isotope.js"></script>
  <script src="assets/js/vendors/scrollup.js"></script>
  <script src="assets/js/vendors/swiper-bundle.min.js"></script>
  <script src="assets/js/vendors/noUISlider.js"></script>
  <script src="assets/js/vendors/slider.js"></script>
  <script src="assets/js/vendors/counterup.js"></script>
  <script src="assets/js/vendors/jquery.countdown.min.js"></script>
  <script src="assets/js/vendors/jquery.elevatezoom.js"></script>
  <script src="assets/js/vendors/slick.js"></script>
  <script src="assets/js/vendors/gsap.min.js"></script>
  <script src="assets/js/main%EF%B9%96v=6.0.0.js"></script>
  <script src="assets/js/ali-animation%EF%B9%96v=1.0.0.js"></script>
  <script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015"
    data-cf-beacon='{"rayId":"94de3d802927a8e4","version":"2025.5.0","r":1,"token":"3aa9a3481f734e94bceb8bb1bd648ba1","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}}}'></script>